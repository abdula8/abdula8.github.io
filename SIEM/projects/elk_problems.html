<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problems I Faced in Installing ELK Stack</title>
    <!-- Link to the shared CSS file (same as your index.html) -->
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <!-- Navigation menu (same as other pages like index.html, about.html, etc.) -->
    <header>
        <h1>My Portfolio</h1>
        <nav>
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../about.html">About Me</a></li>
                <li><a href="../../projects.html">Projects</a></li>
                <li><a href="../../contact.html">Contact</a></li>
                <!-- <li><a href="problems-elk.html">Problems I Faced</a></li> New page -->
            </ul>
        </nav>
    </header>

    <!-- Main content of the page -->
    <section>
        <h2>Problems I Faced in Installing ELK Stack on CentOS 9</h2>

        <h3>General Configurations</h3>
        <p>We use <code>/etc/profile</code> for permanent storage of environmental variables working after a restart.</p>
        <p>Selinux file config: <code>/etc/sysconfig/selinux</code></p>

        <h3>Firewall Commands</h3>
        <pre>
sudo firewall-cmd --permanent --add-port=514/udp
sudo firewall-cmd --permanent --add-port=514/tcp
sudo firewall-cmd --reload
        </pre>

        <h3>ElasticSearch</h3>
        <p>The problem that lasted for about 2 days was related to certificates. After installing Elasticsearch on CentOS 9, I got this error when visiting <a href="https://localhost:9200">https://localhost:9200</a>:</p>
        <pre>{
    "error" : {
        "root_cause" : [ { "type" : "status_exception", "reason" : "Cluster state has not been recovered yet, cannot write to the [null] index" } ],
        "type" : "authentication_processing_error",
        "reason" : "failed to promote the auto-configured elastic password hash",
        "caused_by" : {
            "type" : "status_exception",
            "reason" : "Cluster state has not been recovered yet, cannot write to the [null] index"
        }
    },
    "status" : 503
}
        </pre>
        <p>The solution was changing the following parameter:</p>
        <pre>cluster.initial_master_nodes: ["localhost.localdomain"]</pre>

        <h3>Kibana</h3>
        <p>I faced issues when trying to connect Kibana to Elasticsearch using a token. The error I received was due to a mismatch between the certificate's alternative names and the server IP. The solution was to manually configure the network host:</p>
        <pre>network.publish_host: 127.0.0.1</pre>

        <h3>Logstash</h3>
        <p>Running Logstash as a service resulted in certificate errors with Elasticsearch. I resolved this by running Logstash from its own <code>bin</code> directory and manually copying configuration files.</p>
        <pre>
mkdir /usr/share/logstash/config
cp /etc/logstash/pipelines.yml /usr/share/logstash/config
cp /etc/logstash/log4j2.properties /usr/share/logstash/config
/usr/share/logstash/bin/logstash
        </pre>
    </section>

    <!-- Footer (same as other pages) -->
    <footer>
        <p>&copy; 2024 Your Name</p>
    </footer>
</body>
</html>
